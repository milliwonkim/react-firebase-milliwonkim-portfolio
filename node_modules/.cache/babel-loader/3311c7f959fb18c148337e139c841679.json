{"ast":null,"code":"import _slicedToArray from \"/Users/kiwonkim/Downloads/react-portfolio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/kiwonkim/Downloads/react-portfolio/src/utils/CropHooks.js\";\nimport React, { useState, useEffect } from 'react';\nimport { ReactCrop } from 'react-image-crop';\nimport 'react-image-crop/dist/ReactCrop';\nexport default function CropHooks() {\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      src = _useState2[0],\n      setSrc = _useState2[1];\n\n  var _useState3 = useState({\n    unit: '%',\n    width: 30,\n    aspect: 16 / 9\n  }),\n      _useState4 = _slicedToArray(_useState3, 2),\n      crop = _useState4[0],\n      setCrop = _useState4[1];\n\n  var _useState5 = useState(null),\n      _useState6 = _slicedToArray(_useState5, 2),\n      imageRef = _useState6[0],\n      setImageRef = _useState6[1];\n\n  var _useState7 = useState(''),\n      _useState8 = _slicedToArray(_useState7, 2),\n      croppedImageUrl = _useState8[0],\n      setCroppedImageUrl = _useState8[1];\n\n  var _useState9 = useState(''),\n      _useState10 = _slicedToArray(_useState9, 2),\n      fileUrl = _useState10[0],\n      setFileUrl = _useState10[1]; // useEffect(() => {\n  //     console.log(src, 'src');\n  // }, []);\n\n\n  var onSelectFile = function onSelectFile(e) {\n    if (e.target.files && e.target.files.length > 0) {\n      var reader = new FileReader();\n      console.log(e.target.files[0]);\n      console.log('reader: ', reader);\n      reader.addEventListener('load', function () {\n        return setSrc(reader.result);\n      });\n      reader.readAsDataURL(e.target.files[0]);\n    }\n  }; // If you setState the crop in here you should return false.\n\n\n  var onImageLoaded = function onImageLoaded(image) {\n    setImageRef(image);\n  };\n\n  var onCropComplete = function onCropComplete(crop) {\n    makeClientCrop(crop);\n  };\n\n  var onCropChange = function onCropChange(crop, percentCrop) {\n    // You could also use percentCrop:\n    // this.setState({ crop: percentCrop });\n    setCrop(crop);\n  };\n\n  var makeClientCrop = function makeClientCrop(crop) {\n    if (imageRef && crop.width && crop.height) {\n      var _croppedImageUrl = getCroppedImg(imageRef, crop, 'newFile.jpeg');\n\n      setCroppedImageUrl(_croppedImageUrl);\n    }\n  };\n\n  var getCroppedImg = function getCroppedImg(image, crop, fileName) {\n    var canvas = document.createElement('canvas');\n    var scaleX = image.naturalWidth / image.width;\n    var scaleY = image.naturalHeight / image.height;\n    canvas.width = crop.width;\n    canvas.height = crop.height;\n    var ctx = canvas.getContext('2d');\n    ctx.drawImage(image, crop.x * scaleX, crop.y * scaleY, crop.width * scaleX, crop.height * scaleY, 0, 0, crop.width, crop.height);\n    return new Promise(function (resolve, reject) {\n      canvas.toBlob(function (blob) {\n        if (!blob) {\n          //reject(new Error('Canvas is empty'));\n          console.error('Canvas is empty');\n          return;\n        }\n\n        blob.name = fileName;\n        window.URL.revokeObjectURL(fileUrl);\n        setFileUrl(window.URL.createObjectURL(blob));\n        resolve(fileUrl);\n      }, 'image/jpeg');\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"App\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"file\",\n    accept: \"image/*\",\n    onChange: onSelectFile,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 17\n    }\n  })), src && /*#__PURE__*/React.createElement(ReactCrop, {\n    src: src,\n    crop: crop,\n    ruleOfThirds: true,\n    onImageLoaded: onImageLoaded,\n    onComplete: onCropComplete,\n    onChange: onCropChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 17\n    }\n  }), croppedImageUrl && /*#__PURE__*/React.createElement(\"img\", {\n    alt: \"Crop\",\n    style: {\n      maxWidth: '100%'\n    },\n    src: croppedImageUrl,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 17\n    }\n  }));\n}","map":{"version":3,"sources":["/Users/kiwonkim/Downloads/react-portfolio/src/utils/CropHooks.js"],"names":["React","useState","useEffect","ReactCrop","CropHooks","src","setSrc","unit","width","aspect","crop","setCrop","imageRef","setImageRef","croppedImageUrl","setCroppedImageUrl","fileUrl","setFileUrl","onSelectFile","e","target","files","length","reader","FileReader","console","log","addEventListener","result","readAsDataURL","onImageLoaded","image","onCropComplete","makeClientCrop","onCropChange","percentCrop","height","getCroppedImg","fileName","canvas","document","createElement","scaleX","naturalWidth","scaleY","naturalHeight","ctx","getContext","drawImage","x","y","Promise","resolve","reject","toBlob","blob","error","name","window","URL","revokeObjectURL","createObjectURL","maxWidth"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { ReactCrop } from 'react-image-crop';\nimport 'react-image-crop/dist/ReactCrop';\n\nexport default function CropHooks() {\n    const [src, setSrc] = useState(null);\n    const [crop, setCrop] = useState({\n        unit: '%',\n        width: 30,\n        aspect: 16 / 9,\n    });\n    const [imageRef, setImageRef] = useState(null);\n    const [croppedImageUrl, setCroppedImageUrl] = useState('');\n    const [fileUrl, setFileUrl] = useState('');\n\n    // useEffect(() => {\n    //     console.log(src, 'src');\n    // }, []);\n\n    const onSelectFile = (e) => {\n        if (e.target.files && e.target.files.length > 0) {\n            const reader = new FileReader();\n            console.log(e.target.files[0]);\n            console.log('reader: ', reader);\n            reader.addEventListener('load', () => setSrc(reader.result));\n            reader.readAsDataURL(e.target.files[0]);\n        }\n    };\n\n    // If you setState the crop in here you should return false.\n    const onImageLoaded = (image) => {\n        setImageRef(image);\n    };\n\n    const onCropComplete = (crop) => {\n        makeClientCrop(crop);\n    };\n\n    const onCropChange = (crop, percentCrop) => {\n        // You could also use percentCrop:\n        // this.setState({ crop: percentCrop });\n        setCrop(crop);\n    };\n\n    const makeClientCrop = (crop) => {\n        if (imageRef && crop.width && crop.height) {\n            const croppedImageUrl = getCroppedImg(\n                imageRef,\n                crop,\n                'newFile.jpeg'\n            );\n\n            setCroppedImageUrl(croppedImageUrl);\n        }\n    };\n\n    const getCroppedImg = (image, crop, fileName) => {\n        const canvas = document.createElement('canvas');\n        const scaleX = image.naturalWidth / image.width;\n        const scaleY = image.naturalHeight / image.height;\n        canvas.width = crop.width;\n        canvas.height = crop.height;\n        const ctx = canvas.getContext('2d');\n\n        ctx.drawImage(\n            image,\n            crop.x * scaleX,\n            crop.y * scaleY,\n            crop.width * scaleX,\n            crop.height * scaleY,\n            0,\n            0,\n            crop.width,\n            crop.height\n        );\n\n        return new Promise((resolve, reject) => {\n            canvas.toBlob((blob) => {\n                if (!blob) {\n                    //reject(new Error('Canvas is empty'));\n                    console.error('Canvas is empty');\n                    return;\n                }\n                blob.name = fileName;\n                window.URL.revokeObjectURL(fileUrl);\n                setFileUrl(window.URL.createObjectURL(blob));\n                resolve(fileUrl);\n            }, 'image/jpeg');\n        });\n    };\n\n    return (\n        <div className='App'>\n            <div>\n                <input type='file' accept='image/*' onChange={onSelectFile} />\n            </div>\n            {src && (\n                <ReactCrop\n                    src={src}\n                    crop={crop}\n                    ruleOfThirds\n                    onImageLoaded={onImageLoaded}\n                    onComplete={onCropComplete}\n                    onChange={onCropChange}\n                />\n            )}\n            {croppedImageUrl && (\n                <img\n                    alt='Crop'\n                    style={{ maxWidth: '100%' }}\n                    src={croppedImageUrl}\n                />\n            )}\n        </div>\n    );\n}\n"]},"metadata":{},"sourceType":"module"}